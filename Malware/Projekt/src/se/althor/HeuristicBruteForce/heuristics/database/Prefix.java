package se.althor.HeuristicBruteForce.heuristics.database;

/**
 * 
 * Neighbor tabel for prefixes.
 * 
 * @author Kristian Lundkvist
 * 
 */
public class Prefix extends NeighborTable implements HeuristicCheck {

	private static final long serialVersionUID = 1L;

	@Override
	public boolean isValid(String string) {

		char[] characters = string.substring(0, 3).toCharArray();

		// Check if the prefix is valid.
		if (this.getNextTo(characters[0], characters[1]) < NeighborTable.getSensitivity()
				|| this.getNextTo(characters[1], characters[2]) < NeighborTable.getSensitivity()) {
			return false;
		}

		return true;
	}

	@Override
	public void analyseWord(String word) {
		char[] characters = word.substring(0, 3).toCharArray();

		this.increaseNextTo(characters[0], characters[1]);
		this.increaseNextTo(characters[1], characters[2]);

	}

}
